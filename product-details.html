<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Product Details - Normalitylb</title>
<link rel="stylesheet" href="styles.css">
<style>
  /* Tabs Styles */
  .tabs { margin-top: 20px; }
  .tab-buttons { display: flex; gap: 10px; margin-bottom: 10px; }
  .tab-buttons button {
      padding: 8px 15px; border: none; cursor: pointer; background: #eee;
      border-radius: 5px; transition: 0.2s;
  }
  .tab-buttons button.active {
      background: #c3026c; color: white;
  }
  .tab-content {
      display: none; background: #f9f9f9; padding: 15px; border-radius: 8px;
  }
  .tab-content.active { display: block; }
  .variant-option img { width: 70px; height: 70px; border-radius: 10px; object-fit: cover; cursor: pointer; }
</style>
</head>
<body style="padding-top:120px;">

<div class="container" id="detailsContainer"></div>

<script>
const product = JSON.parse(localStorage.getItem("selectedProduct"));
const container = document.getElementById("detailsContainer");

if(!product){
    container.innerHTML = "<h1>No product found</h1>";
}else{
    let mainImage = product.image;
    let productTitleText = product.name;
    let variantsHTML = "";

    // ÿ•ÿ∞ÿß ŸÅŸäŸá Variants
    if(product.variants && product.variants.length > 0){
        mainImage = product.variants[0].image;
        productTitleText = `${product.name} - ${product.variants[0].name}`;

        variantsHTML = `
        <h4 style="margin-top:15px;">Choose scent:</h4>
        <div style="display:flex;gap:10px;margin-bottom:15px;">
        ${product.variants.map(v => `
            <div class="variant-option" onclick="changeVariant('${v.image}','${v.name}')">
                <img src="${v.image}" alt="${v.name}">
                <small>${v.name}</small>
            </div>
        `).join('')}
        </div>
        `;
    }

    container.innerHTML = `
        <a href="products.html" class="back-btn">‚Üê Back to Products</a>
        <div class="product-details-wrapper">
            <div>
                <img id="mainImage" src="${mainImage}" class="product-details-image">
                ${variantsHTML}
            </div>
            <div class="product-details-info">
                <h2 id="productTitle">${productTitleText}</h2>
                <p>${product.description}</p>
                <h2>${product.price}</h2>

                <div class="tabs">
                    <div class="tab-buttons">
                        <button class="tab-btn active" data-tab="howToUse">How to Use</button>
                        <button class="tab-btn" data-tab="ingredients">Ingredients</button>
                        <button class="tab-btn" data-tab="benefits">Benefits</button>
                    </div>
                    <div id="howToUse" class="tab-content active">
                        <p>${product.howToUse}</p>
                    </div>
                    <div id="ingredients" class="tab-content">
                        <p>${product.ingredients}</p>
                    </div>
                    <div id="benefits" class="tab-content">
                        <p>${product.benefits}</p>
                    </div>
                </div>

                <button class="big-add-cart" onclick="addVariantToCart()">Add to Cart</button>
            </div>
        </div>
    `;
}

// ===============================
// FUNCTIONS
// ===============================
function changeVariant(img, name){
    document.getElementById("mainImage").src = img;
    document.getElementById("productTitle").textContent = `${product.name} - ${name}`;
}

function addVariantToCart(){
    let cart = JSON.parse(localStorage.getItem("cart")) || [];
    cart.push({
        name: document.getElementById("productTitle").textContent,
        price: product.price,
        image: document.getElementById("mainImage").src
    });
    localStorage.setItem("cart", JSON.stringify(cart));
    alert("Added to cart üõí");
}

// ===============================
// TABS FUNCTIONALITY
// ===============================
const tabButtons = document.querySelectorAll('.tab-btn');
const tabContents = document.querySelectorAll('.tab-content');

tabButtons.forEach(btn => {
    btn.addEventListener('click', ()=>{
        const target = btn.dataset.tab;

        tabButtons.forEach(b => b.classList.remove('active'));
        tabContents.forEach(c => c.classList.remove('active'));

        btn.classList.add('active');
        document.getElementById(target).classList.add('active');
    });
});
</script>

</body>
</html>
